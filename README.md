# Anki Card Creator — Chrome拡張機能

> **Webページの好きな部分を切り取って、暗記カードを一瞬で作れるツールです。**

勉強中のWebページやPDF教材を見ながら、ドラッグで範囲を選ぶだけでAnkiのフラッシュカードが完成します。解答がない問題でも、AIが自動で解説を生成してくれます。

## 目次
- [🔰 Ankiを知らない方へ](#-ankiを知らない方へ)
- [✨ できること](#-できること)
- [📦 インストール手順](#-インストール手順)
- [🚀 使い方](#-使い方)
- [🤖 AI解説機能（オプション）](#-ai解説機能オプション)
- [❓ よくある質問・トラブルシューティング](#-よくある質問トラブルシューティング)
- [🔒 プライバシー](#-プライバシー)
- [📁 プロジェクト構成](#-プロジェクト構成)

---

## 🔰 Ankiを知らない方へ

**[Anki](https://apps.ankiweb.net/)** は、世界中で使われている無料のフラッシュカード（暗記カード）アプリです。

- 🧠 「忘却曲線」に基づいて、忘れかけたタイミングで自動的に復習を出してくれます
- 📱 PC・スマホ・タブレットで同期できるので、通勤・通学中にも復習できます
- 🎓 医学生・語学学習者・資格試験の受験生を中心に、幅広く利用されています

> まだAnkiをインストールしていない方は、[公式サイト](https://apps.ankiweb.net/) からダウンロードしてください（Windows / Mac / Linux対応、無料）。

---

## ✨ できること

| 機能 | 説明 |
|---|---|
| 📸 範囲選択キャプチャ | Webページの好きな部分をドラッグで囲むだけで画像になります |
| 🃏 即座にカード作成 | キャプチャした画像をAnkiカードの「問題面」「解答面」にセットし、ワンクリックで保存 |
| 🤖 AI解説生成 | 解答がなくても、問題画像をAIに読み込ませて解説を自動生成 |
| 📚 複数画像対応 | 1枚のカードに複数の画像を追加可能 |
| 🌳 デッキツリー表示 | Ankiのデッキ構造をツリー形式で選択 |

---

## 📦 インストール手順

### ステップ1: Ankiをインストールする

> すでにAnkiをお使いの方はステップ2へ進んでください。

1. [Anki公式サイト](https://apps.ankiweb.net/) にアクセスします
2. お使いのOS用のインストーラーをダウンロードします
3. インストール後、Ankiを起動します
4. 初回起動時に言語選択が表示されます。お好みの言語を選んでください

### ステップ2: AnkiConnectアドオンを導入する

**AnkiConnect** は、Ankiと他のアプリを連携させるためのアドオン（追加機能）です。このChrome拡張機能がAnkiと通信するために必要です。

1. Ankiを開きます
2. メニューバーから **ツール** → **アドオン** を選択します
3. **「新たにアドオンを入手する」** をクリックします
4. コード欄に `2055492159` を入力して **OK** を押します
5. インストール完了後、**Ankiを再起動** します

> 💡 AnkiConnectが正しく動作しているか確認するには、Ankiを起動した状態でブラウザのアドレスバーに `localhost:8765` と入力してください。`AnkiConnect v.6` のような表示が出れば成功です。

### ステップ3: Chrome拡張機能を読み込む

> 現在Chrome Web Storeには未公開のため、手動で読み込む必要があります。

1. このリポジトリをローカルにクローンまたはダウンロードします
   ```
   git clone https://github.com/showstarkm1129/AnkiProject.git
   ```
2. Chromeで `chrome://extensions` を開きます
3. 右上の **「デベロッパーモード」** をONにします
4. **「パッケージ化されていない拡張機能を読み込む」** をクリックします
5. クローンしたフォルダ内の `AnkiProject` フォルダを選択します
6. ツールバーにアイコンが表示されれば完了です

> 💡 アイコンが見当たらない場合は、ツールバー右上の **パズルマーク（🧩）** をクリックし、「Anki Card Creator」の横にあるピンマークを押して固定してください。

---

## 🚀 使い方

### 基本の流れ

1. **Ankiを起動** しておきます（バックグラウンドで動作していればOK）
2. 暗記したいWebページを開きます
3. ツールバーの **拡張アイコン** をクリックしてポップアップを開きます
4. **デッキ** と **ノートタイプ** を選択します（初回のみ。次回以降は記憶されます）
5. **「📝 問題を追加」** をクリック → ページ上でドラッグして範囲を選択します
6. もう一度拡張アイコンをクリック → **「📝 解説を追加」** → 同様に範囲を選択します
7. **「💾 カードを保存」** をクリック → Ankiにカードが追加されます！
8. 次のカードの作成へ 🎉

### 🤖 AI解説機能（オプション）

問題の画像だけあれば、AIが自動で解説を書いてくれる機能です。

#### セットアップ

1. ポップアップ内の **「AI解説モード」** をONにします
2. 使いたいAIプロバイダーを選択します：

| プロバイダー | APIキー取得先 |
|---|---|
| **Gemini** | [Google AI Studio](https://aistudio.google.com/) |
| **OpenAI** | [OpenAI Platform](https://platform.openai.com/api-keys) |
| **Anthropic** | [Anthropic Console](https://console.anthropic.com/) |
| **OpenRouter** | [OpenRouter](https://openrouter.ai/keys) |

3. 選択したプロバイダーの **APIキー** を入力して **保存** します

> 💡 **Geminiの場合のAPIキー取得方法：**
> [Google AI Studio](https://aistudio.google.com/) にログイン → **Get API Key** → プロジェクトを作成 → キーをコピー

#### 使い方

1. 問題画像をキャプチャします（通常通り）
2. 拡張アイコンをクリック → **「🤖 AI解説を生成」** をクリックします
3. AIが画像を分析して解説文を生成します
4. 生成された解説がカードの裏面にセットされます
5. **「💾 カードを保存」** で完成！

---

## ❓ よくある質問・トラブルシューティング

| 症状 | 対処法 |
|---|---|
| 「AnkiConnectに接続できません」 | Ankiアプリが起動しているか確認してください。起動していてもダメな場合は、Ankiを再起動してください |
| 拡張アイコンが見つからない | ツールバーの🧩マーク → Anki Card Creatorをピン留めしてください |
| 範囲選択のドラッグが反応しない | ページを一度クリック（フォーカス）してから再試行してください |
| AI解説で「APIキーを設定してください」と出る | ポップアップのAI設定でキーを入力 → **保存ボタン**を押してください |
| AI解説で「未対応のAPI」と出る | プロバイダーを正しく選択しているか確認してください |
| 保存したカードがAnkiで見つからない | Ankiで選択したデッキが正しいか確認してください。同期ボタンも押してみてください |

---

## 🔒 プライバシー

- APIキーはお使いのブラウザのローカルストレージに保存され、**外部には一切送信されません**
- AI解説機能を使う場合のみ、選択したAIプロバイダーへ画像とプロンプトが送信されます
- 詳細は [PRIVACY_POLICY.md](./PRIVACY_POLICY.md) をご覧ください

---

## 📁 プロジェクト構成

```
AnkiProject/
├── manifest.json          # 拡張機能設定
├── LICENSE                # MITライセンス
├── PRIVACY_POLICY.md      # プライバシーポリシー
├── popup/                 # ツールバーポップアップ
│   ├── popup.html
│   ├── popup.css
│   └── popup.js
├── content/               # ページ注入スクリプト（範囲選択UI）
│   └── content.js
├── background/            # バックグラウンド処理（API通信等）
│   └── background.js
└── icons/                 # アイコン
    ├── icon16.png
    ├── icon48.png
    └── icon128.png
```

## 技術スタック

- Chrome Extension Manifest V3
- AnkiConnect REST API
- Vanilla JavaScript

## ライセンス

[MIT License](./LICENSE)